# Kasi Sacred Boundary - Build Instructions

## Prerequisites
- âœ… Node.js v20.20.0 (LTS)
- âœ… Android Studio with SDK
- âœ… USB Debugging enabled on device
- âœ… Google Maps API Key

## Quick Build Steps

### 1. Update API Key
Open `app.json` and replace `YOUR_API_KEY_HERE` with your actual Google Maps API key in TWO places:
- `android.config.googleMaps.apiKey`
- `plugins[2][1].googleMapsApiKey` (react-native-maps plugin)

### 2. Clean Build
Run the automated clean build script:
```cmd
clean-build.bat
```

This will:
- Delete node_modules
- Delete android folder
- Install dependencies
- Run expo prebuild

### 3. Build and Install
```cmd
npx expo run:android
```

## Manual Build Steps (if script fails)

### Step 1: Clean
```cmd
rmdir /s /q node_modules
rmdir /s /q android
```

### Step 2: Install
```cmd
npm install
```

### Step 3: Prebuild
```cmd
npx expo prebuild --clean
```

### Step 4: Build
```cmd
npx expo run:android
```

## Generate Release APK

### Debug APK (for testing)
```cmd
cd android
gradlew assembleDebug
```
APK location: `android/app/build/outputs/apk/debug/app-debug.apk`

### Release APK (for distribution)
```cmd
cd android
gradlew assembleRelease
```
APK location: `android/app/build/outputs/apk/release/app-release.apk`

## Troubleshooting

### CMake/Codegen Errors
- Delete `android` folder
- Delete `node_modules`
- Run `npm install` again
- Run `npx expo prebuild --clean`

### EPERM Lock Issues
- Close all terminals
- Close Android Studio
- Restart system
- Try again

### Maps Not Showing
1. Verify API key is correct in `app.json`
2. Ensure Maps SDK for Android is enabled in Google Cloud Console
3. Ensure billing is enabled
4. Rebuild: `npx expo prebuild --clean && npx expo run:android`

### ADB Device Not Found
```cmd
adb devices
adb kill-server
adb start-server
```

## API Key Security

âš ï¸ **Important**: Never commit your API key to public repositories!

### Secure the API Key (Recommended)
1. Create `.env` file (add to .gitignore):
```
GOOGLE_MAPS_API_KEY=your_actual_key_here
```

2. Install dotenv:
```cmd
npm install --save-dev dotenv
```

3. Update app.json to use environment variable (requires app.config.js instead)

## App Features
- ğŸ—ºï¸ Google Maps with sacred boundary polygon
- ğŸ“ GPS location tracking
- âœ… Inside/Outside boundary detection
- ğŸ“³ Vibration alert when outside
- ğŸ“… Day counter for time spent inside
- ğŸ’¾ Persistent storage with AsyncStorage

## Project Structure
```
KASI_PANCHKROSH/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (tabs)/
â”‚   â”‚   â””â”€â”€ index.tsx          # Main app screen
â”‚   â””â”€â”€ _layout.tsx
â”œâ”€â”€ assets/
â”œâ”€â”€ android/                    # Generated by prebuild
â”œâ”€â”€ app.json                    # Expo config (includes API key)
â”œâ”€â”€ package.json
â””â”€â”€ clean-build.bat            # Automated build script
```

## Next Steps After Successful Build
1. Test GPS functionality
2. Test boundary detection
3. Test day counter
4. Generate release APK
5. Regenerate API key (if exposed)
6. Add API key restrictions in Google Cloud Console
